
<!-- saved from url=(0043)http://www.cs.rit.edu/~rjb6296/jquery_demo/ -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<script type="text/javascript" src="http://www.cs.rit.edu/~rjb6296/jquery_demo/js/jquery.js"></script><style type="text/css"></style>
<script type="text/javascript" src="http://www.cs.rit.edu/~rjb6296/jquery_demo/js/jquery.cookie.js"></script>
<script type="text/javascript" src="http://www.cs.rit.edu/~rjb6296/jquery_demo/js/jquery-ui-1.8.2.custom.min.js"></script>
<link type="text/css" href="http://www.cs.rit.edu/~rjb6296/jquery_demo/css/smoothness/jquery-ui-1.8.2.custom.css" rel="Stylesheet">

<style type="text/css" media="screen">
    .column { width: 400px; float: left; padding-bottom: 200px; }
    .tablecolumn { width: 600px; float: left; padding-bottom: 200px; }
    .portlet { margin: 0 1em 1em 0; }
    .portlet-header {
        font-size:13px; margin: 0.3em;
        padding-bottom: 4px; padding-left: 0.2em; }
    .portlet-header .ui-icon { float: right; }
    .portlet-content { padding: 0.4em; }
    .ui-sortable-placeholder {
        border: 1px dotted black;
        visibility: visible !important;
        height: 200px !important; }
    .ui-sortable-placeholder * { visibility: hidden; }

    body { font: 62.5% "Trebuchet MS", sans-serif; }
</style>

<script type="text/javascript">

// function that writes the list order to a cookie
function saveOrder() {
    $(".column").each(function(index, value){
        var colid = value.id;
        var cookieName = "cookie-" + colid;
        // Get the order for this column.
        var order = $('#' + colid).sortable("toArray");
        // For each portlet in the column
        for ( var i = 0, n = order.length; i < n; i++ ) {
            // Determine if it is 'opened' or 'closed'
            var v = $('#' + order[i] ).find('.portlet-content').is(':visible');
            // Modify the array we're saving to indicate what's open and
            //  what's not.
            order[i] = order[i] + ":" + v;
        }
        $.cookie(cookieName, order, { path: "/", expiry: new Date(2012, 1, 1)});
    });
}

// function that restores the list order from a cookie
function restoreOrder() {
    $(".column").each(function(index, value) {
        var colid = value.id;
        var cookieName = "cookie-" + colid
        var cookie = $.cookie(cookieName);
        if ( cookie == null ) { return; }
        var IDs = cookie.split(",");
        for (var i = 0, n = IDs.length; i < n; i++ ) {
            var toks = IDs[i].split(":");
            if ( toks.length != 2 ) {
                continue;
            }
            var portletID = toks[0];
            var visible = toks[1]
            var portlet = $(".column")
                .find('#' + portletID)
                .appendTo($('#' + colid));
            if (visible === 'false') {
                portlet.find(".ui-icon").toggleClass("ui-icon-minus");
                portlet.find(".ui-icon").toggleClass("ui-icon-plus");
                portlet.find(".portlet-content").hide();
            }
        }
    });
} 


$(document).ready( function () {
    $(".column").sortable({
        connectWith: ['.column'],
        stop: function() { saveOrder(); }
    }); 

    $(".portlet")
        .addClass("ui-widget ui-widget-content")
        .addClass("ui-helper-clearfix ui-corner-all")
        .find(".portlet-header")
        .addClass("ui-widget-header ui-corner-all")
        .prepend('<span class="ui-icon ui-icon-minus"></span>')
        .end()
        .find(".portlet-content");

    restoreOrder();

    $(".portlet-header .ui-icon").click(function() {
        $(this).toggleClass("ui-icon-minus");
        $(this).toggleClass("ui-icon-plus");
        $(this).parents(".portlet:first").find(".portlet-content").toggle();
        saveOrder(); // This is important
    });
    $(".portlet-header .ui-icon").hover(
        function() {$(this).addClass("ui-icon-hover"); },
        function() {$(this).removeClass('ui-icon-hover'); }
    );
}); 

</script>
</head>

<body>
    <div class="ui-widget">
        <div class="ui-widget-header">
            Saving Multiple Portlet Columns and Portlet State with Cookies
        </div>
        <div class="ui-content">
            Try moving the portlets around and minimizing them, then reload the page to test restoration-by-cookie.
        </div>
    </div>
<div class="column ui-sortable" id="col1">
    
    
<div class="portlet ui-widget ui-widget-content ui-helper-clearfix ui-corner-all" id="box_feeds">
        <div class="portlet-header ui-widget-header ui-corner-all"><span class="ui-icon ui-icon-minus"></span>1</div>
        <div class="portlet-content">
            Lorem ipsum dolor sit amet, consectetuer adipiscing elit
        </div>
    </div><div class="portlet ui-widget ui-widget-content ui-helper-clearfix ui-corner-all" id="box_shopping">
        <div class="portlet-header ui-widget-header ui-corner-all"><span class="ui-icon ui-icon-minus"></span>2</div>
        <div class="portlet-content">
            Lorem ipsum dolor sit amet, consectetuer adipiscing elit
        </div>
    </div><div class="portlet ui-widget ui-widget-content ui-helper-clearfix ui-corner-all" id="box_news">
        <div class="portlet-header ui-widget-header ui-corner-all"><span class="ui-icon ui-icon-minus"></span>3</div>
        <div class="portlet-content">
            Lorem ipsum dolor sit amet, consectetuer adipiscing elit
        </div>
    </div><div class="portlet ui-widget ui-widget-content ui-helper-clearfix ui-corner-all" id="box_links">
        <div class="portlet-header ui-widget-header ui-corner-all"><span class="ui-icon ui-icon-minus"></span>4</div>
        <div class="portlet-content">
            Lorem ipsum dolor sit amet, consectetuer adipiscing elit
        </div>
    </div><div class="portlet ui-widget ui-widget-content ui-helper-clearfix ui-corner-all" id="box_images">
        <div class="portlet-header ui-widget-header ui-corner-all"><span class="ui-icon ui-icon-minus"></span>5</div>
        <div class="portlet-content">
            Lorem ipsum dolor sit amet, consectetuer adipiscing elit
        </div>
    </div></div>
<div class="column ui-sortable" id="col2">
    
</div>
<div class="column ui-sortable" id="col3">
    
    
</div> 


</body></html>